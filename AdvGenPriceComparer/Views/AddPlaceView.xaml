<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="AdvGenPriceComparer.Desktop.WinUI.Views.AddPlaceView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:AdvGenPriceComparer.Desktop.WinUI.ViewModels">

    <ScrollViewer MaxHeight="500" VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="16" Margin="8">
            <!-- Header -->
            <TextBlock Text="Add New Store/Supermarket" 
                      FontSize="18" FontWeight="SemiBold"
                      Margin="0,0,0,8"/>
            
            <TextBlock Text="Add a new supermarket or store location to track grocery prices." 
                      TextWrapping="Wrap" 
                      Foreground="{StaticResource TextSecondaryBrush}"
                      Margin="0,0,0,12"/>

            <!-- Basic Store Information -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Store Information" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Store Name (Required) -->
                    <StackPanel>
                        <TextBlock Text="Store Name *" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.StoreName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., Coles Chatswood, Woolworths Town Hall"/>
                    </StackPanel>

                    <!-- Chain (Required) -->
                    <StackPanel>
                        <TextBlock Text="Chain *" FontWeight="Medium"/>
                        <ComboBox ItemsSource="{x:Bind ViewModel.Chains}" 
                                 SelectedItem="{x:Bind ViewModel.Chain, Mode=TwoWay}"
                                 PlaceholderText="Select or enter chain"
                                 IsEditable="True"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Location Information -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Location" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Address -->
                    <StackPanel>
                        <TextBlock Text="Street Address" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Address, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., 123 Main Street"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                Height="60"/>
                    </StackPanel>

                    <!-- Suburb (Required) -->
                    <StackPanel>
                        <TextBlock Text="Suburb *" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Suburb, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., Chatswood, Sydney"/>
                    </StackPanel>

                    <!-- State and Postcode -->
                    <Grid ColumnDefinitions="*,12,150">
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="State *" FontWeight="Medium"/>
                            <ComboBox ItemsSource="{x:Bind ViewModel.States}" 
                                     SelectedItem="{x:Bind ViewModel.State, Mode=TwoWay}"
                                     PlaceholderText="Select state"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Postcode" FontWeight="Medium"/>
                            <TextBox Text="{x:Bind ViewModel.Postcode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                    PlaceholderText="e.g., 2067"/>
                            <TextBlock Text="{x:Bind ViewModel.PostcodeError, Mode=OneWay}" 
                                      Foreground="Red" FontSize="12" 
                                      Visibility="{x:Bind ViewModel.HasPostcodeError, Mode=OneWay}"/>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Contact Information -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Contact Information (Optional)" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Phone -->
                    <StackPanel>
                        <TextBlock Text="Phone Number" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Phone, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., (02) 9876 5432"/>
                        <TextBlock Text="{x:Bind ViewModel.PhoneError, Mode=OneWay}" 
                                  Foreground="Red" FontSize="12" 
                                  Visibility="{x:Bind ViewModel.HasPhoneError, Mode=OneWay}"/>
                    </StackPanel>

                    <!-- Website -->
                    <StackPanel>
                        <TextBlock Text="Website" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Website, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="https://www.example.com"/>
                        <TextBlock Text="{x:Bind ViewModel.WebsiteError, Mode=OneWay}" 
                                  Foreground="Red" FontSize="12" 
                                  Visibility="{x:Bind ViewModel.HasWebsiteError, Mode=OneWay}"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Store Features -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Store Features (Optional)" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Operating Hours -->
                    <StackPanel>
                        <TextBlock Text="Operating Hours" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.OperatingHours, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., Mon-Fri: 6am-10pm, Sat-Sun: 7am-9pm"/>
                    </StackPanel>

                    <!-- Services -->
                    <StackPanel>
                        <TextBlock Text="Services Available" FontWeight="Medium"/>
                        <ItemsControl ItemsSource="{x:Bind ViewModel.Services}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:ServiceViewModel">
                                    <CheckBox Content="{x:Bind DisplayName}" 
                                             IsChecked="{x:Bind IsSelected, Mode=TwoWay}"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Location Coordinates (Advanced) -->
            <Expander Header="Advanced Location (GPS Coordinates)" IsExpanded="False">
                <Border Background="{StaticResource CardBackgroundBrush}" 
                        CornerRadius="8" Padding="16" Margin="0,8,0,0">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Enter GPS coordinates for precise location mapping" 
                                  Foreground="{StaticResource TextSecondaryBrush}"/>
                        
                        <Grid ColumnDefinitions="*,12,*">
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Latitude" FontWeight="Medium"/>
                                <TextBox Text="{x:Bind ViewModel.Latitude, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        PlaceholderText="e.g., -33.7969"/>
                                <TextBlock Text="{x:Bind ViewModel.LatitudeError, Mode=OneWay}" 
                                          Foreground="Red" FontSize="12" 
                                          Visibility="{x:Bind ViewModel.HasLatitudeError, Mode=OneWay}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Longitude" FontWeight="Medium"/>
                                <TextBox Text="{x:Bind ViewModel.Longitude, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                        PlaceholderText="e.g., 151.1316"/>
                                <TextBlock Text="{x:Bind ViewModel.LongitudeError, Mode=OneWay}" 
                                          Foreground="Red" FontSize="12" 
                                          Visibility="{x:Bind ViewModel.HasLongitudeError, Mode=OneWay}"/>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </Border>
            </Expander>

            <!-- Validation Summary -->
            <Border Background="#FFEBEE" 
                   BorderBrush="Red" 
                   BorderThickness="1"
                   CornerRadius="4" 
                   Padding="12"
                   Visibility="{x:Bind ViewModel.ValidationErrors, Mode=OneWay, Converter={StaticResource StringToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="Please fix the following errors:" 
                              FontWeight="SemiBold" 
                              Foreground="Red"/>
                    <TextBlock Text="{x:Bind ViewModel.ValidationErrors, Mode=OneWay}" 
                              Foreground="Red" 
                              TextWrapping="Wrap"
                              Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</UserControl>