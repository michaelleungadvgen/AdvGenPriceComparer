<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="AdvGenPriceComparer.Desktop.WinUI.Views.AddItemView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:AdvGenPriceComparer.Desktop.WinUI.ViewModels">

    <ScrollViewer MaxHeight="500" VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="16" Margin="8">
            <!-- Header -->
            <TextBlock Text="Add New Grocery Item" 
                      FontSize="18" FontWeight="SemiBold"
                      Margin="0,0,0,8"/>
            
            <TextBlock Text="Fill in the information below to add a new item to track prices across supermarkets." 
                      TextWrapping="Wrap" 
                      Foreground="{StaticResource TextSecondaryBrush}"
                      Margin="0,0,0,12"/>

            <!-- Basic Information Section -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Basic Information" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Name (Required) -->
                    <StackPanel>
                        <TextBlock Text="Product Name *" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., White Bread, Full Cream Milk"/>
                    </StackPanel>

                    <!-- Brand -->
                    <StackPanel>
                        <TextBlock Text="Brand" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Brand, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., Tip Top, Dairy Farmers"/>
                    </StackPanel>

                    <!-- Description -->
                    <StackPanel>
                        <TextBlock Text="Description" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="Brief description of the product"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                Height="60"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Category Section -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Category and Classification" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Category -->
                    <StackPanel>
                        <TextBlock Text="Category" FontWeight="Medium"/>
                        <ComboBox ItemsSource="{x:Bind ViewModel.Categories}" 
                                 SelectedItem="{x:Bind ViewModel.Category, Mode=TwoWay}"
                                 PlaceholderText="Select category"
                                 IsEditable="True"/>
                    </StackPanel>

                    <!-- Sub Category -->
                    <StackPanel>
                        <TextBlock Text="Sub Category" FontWeight="Medium"/>
                        <ComboBox ItemsSource="{x:Bind ViewModel.SubCategories}" 
                                 SelectedItem="{x:Bind ViewModel.SubCategory, Mode=TwoWay}"
                                 PlaceholderText="Select sub category"
                                 IsEditable="True"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Product Details Section -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Product Details" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Package Size -->
                    <StackPanel>
                        <TextBlock Text="Package Size" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.PackageSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., 680g, 2L, 500ml, 12 pack"/>
                        <TextBlock Text="{x:Bind ViewModel.PackageSizeHint, Mode=OneWay}" 
                                  Foreground="{StaticResource TextSecondaryBrush}" 
                                  FontSize="12" 
                                  Margin="0,4,0,0"
                                  Visibility="{x:Bind ViewModel.PackageSizeHint, Mode=OneWay, Converter={StaticResource StringToVisibilityConverter}}"/>
                    </StackPanel>

                    <!-- Unit -->
                    <StackPanel>
                        <TextBlock Text="Unit" FontWeight="Medium"/>
                        <ComboBox ItemsSource="{x:Bind ViewModel.Units}" 
                                 SelectedItem="{x:Bind ViewModel.Unit, Mode=TwoWay}"
                                 PlaceholderText="Select unit"/>
                    </StackPanel>

                    <!-- Barcode -->
                    <StackPanel>
                        <TextBlock Text="Barcode" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Barcode, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., 9310072123456"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Health & Diet Section -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Health and Dietary Information" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Dietary Flags -->
                    <StackPanel>
                        <TextBlock Text="Dietary Flags" FontWeight="Medium"/>
                        <ItemsControl ItemsSource="{x:Bind ViewModel.DietaryFlags}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:DietaryFlagViewModel">
                                    <CheckBox Content="{x:Bind Name}" 
                                             IsChecked="{x:Bind IsSelected, Mode=TwoWay}"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>

                    <!-- Allergens -->
                    <StackPanel>
                        <TextBlock Text="Contains Allergens" FontWeight="Medium"/>
                        <ItemsControl ItemsSource="{x:Bind ViewModel.Allergens}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:AllergenViewModel">
                                    <CheckBox Content="{x:Bind Name}" 
                                             IsChecked="{x:Bind IsSelected, Mode=TwoWay}"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>

                    <!-- Tags -->
                    <StackPanel>
                        <TextBlock Text="Tags (comma separated)" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.Tags, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="e.g., healthy, breakfast, daily, premium"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Additional Information -->
            <Border Background="{StaticResource CardBackgroundBrush}" 
                    CornerRadius="8" Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Additional Information" FontWeight="SemiBold" FontSize="14"/>
                    
                    <!-- Image URL -->
                    <StackPanel>
                        <TextBlock Text="Image URL (optional)" FontWeight="Medium"/>
                        <TextBox Text="{x:Bind ViewModel.ImageUrl, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                PlaceholderText="https://example.com/image.jpg"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Validation Summary -->
            <Border Background="#FFEBEE" 
                   BorderBrush="Red" 
                   BorderThickness="1"
                   CornerRadius="4" 
                   Padding="12"
                   Visibility="{x:Bind ViewModel.ValidationErrors, Mode=OneWay, Converter={StaticResource StringToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="Please fix the following errors:" 
                              FontWeight="SemiBold" 
                              Foreground="Red"/>
                    <TextBlock Text="{x:Bind ViewModel.ValidationErrors, Mode=OneWay}" 
                              Foreground="Red" 
                              TextWrapping="Wrap"
                              Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</UserControl>