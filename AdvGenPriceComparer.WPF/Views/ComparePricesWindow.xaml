<Window x:Class="AdvGenPriceComparer.WPF.Views.ComparePricesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="{Binding Title}"
        Height="500"
        Width="700"
        WindowStartupLocation="CenterOwner"
        Background="White"
        ResizeMode="CanResizeWithGrip">
    <Grid Margin="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#f8fafb" BorderBrush="#e2e8f0" BorderThickness="0,0,0,1" Padding="24,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <TextBlock Text="Price Comparison" FontSize="20" FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding TotalItems, StringFormat='Comparing {0} items across stores'}" 
                               FontSize="13" Foreground="#666" Margin="0,4,0,0"/>
                </StackPanel>

                <Button Grid.Column="1"
                        Content="Close"
                        Click="CloseButton_Click"
                        Width="80"
                        Height="36"
                        Background="#111"
                        Foreground="White"
                        BorderThickness="0"
                        Cursor="Hand"
                        FontSize="14"
                        VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <!-- Store Comparison List -->
        <DataGrid Grid.Row="1"
                  ItemsSource="{Binding StoreComparisons}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  BorderThickness="0"
                  Background="White"
                  RowHeight="52"
                  CanUserResizeRows="False"
                  FontSize="13"
                  Margin="24,16">

            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="#f8fafb"/>
                    <Setter Property="Foreground" Value="#666"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="FontSize" Value="12"/>
                    <Setter Property="Padding" Value="16,12"/>
                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                    <Setter Property="BorderBrush" Value="#e2e8f0"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="Background" Value="White"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsLowest}" Value="True">
                            <Setter Property="Background" Value="#f0fff4"/>
                        </DataTrigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#f9f9f9"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>

            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Padding" Value="16,0"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="DataGridCell">
                                <Border Background="{TemplateBinding Background}"
                                        Padding="{TemplateBinding Padding}">
                                    <ContentPresenter VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DataGrid.CellStyle>

            <DataGrid.Columns>
                <!-- Store Name -->
                <DataGridTextColumn Header="Store" Binding="{Binding StoreName}" Width="2*" MinWidth="150">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="SemiBold"/>
                            <Setter Property="FontSize" Value="14"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- Average Price -->
                <DataGridTextColumn Header="Average Price" Binding="{Binding AveragePriceDisplay}" Width="*">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Bold"/>
                            <Setter Property="FontSize" Value="16"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsLowest}" Value="True">
                                    <Setter Property="Foreground" Value="#16a34a"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- Item Count -->
                <DataGridTextColumn Header="Items Tracked" Binding="{Binding ItemCount}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#666"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!-- Status -->
                <DataGridTemplateColumn Header="Status" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border Background="#16a34a" CornerRadius="4" Padding="8,4" HorizontalAlignment="Left"
                                    Visibility="{Binding IsLowest, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <TextBlock Text="BEST VALUE" Foreground="White" FontSize="11" FontWeight="Bold"/>
                            </Border>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Footer -->
        <Border Grid.Row="2" Background="#f8fafb" BorderBrush="#e2e8f0" BorderThickness="0,1,0,0" Padding="24,16">
            <Grid>
                <TextBlock Text="Green highlighted row indicates the store with the lowest average prices"
                           FontSize="12" Foreground="#666" FontStyle="Italic"/>
            </Grid>
        </Border>
    </Grid>
</Window>
